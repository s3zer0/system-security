{
    "PyYAML": {
        "5.3.1": {
            "cves": [
                "CVE-2020-14343"
            ],
            "mapping_result": {
                "CVE-2020-14343": {
                    "apis": [
                        "full_load",
                        "add_constructor"
                    ],
                    "reason": "The CVE description explicitly states 'arbitrary code execution when it processes untrusted YAML files through the full_load method or with the FullLoader loader' and mentions 'abusing the python/object/new constructor'. The full_load API is directly named as the vulnerable method. The add_constructor API is related because it allows registration of custom constructors including the python/object/new constructor that enables the arbitrary code execution vulnerability."
                }
            }
        }
    },
    "setuptools": {
        "58.1.0": {
            "cves": [
                "CVE-2022-40897",
                "CVE-2024-6345",
                "CVE-2025-47273"
            ],
            "mapping_result": {
                "CVE-2022-40897": {
                    "apis": [
                        "package_index.distros_for_url",
                        "package_index.interpret_distro_name",
                        "package_index.parse_bdist_wininst"
                    ],
                    "reason": "The CVE description explicitly states 'There is a Regular Expression Denial of Service (ReDoS) in package_index.py' and mentions 'HTML in a crafted package or custom PackageIndex page'. The APIs distros_for_url, interpret_distro_name, and parse_bdist_wininst are functions in the package_index module that parse and process package information from URLs and package metadata, which would involve regular expression operations on potentially malicious HTML content."
                },
                "CVE-2024-6345": {
                    "apis": [
                        "package_index.distros_for_url",
                        "package_index.interpret_distro_name",
                        "package_index.parse_bdist_wininst"
                    ],
                    "reason": "The CVE description states 'A vulnerability in the package_index module of pypa/setuptools' and mentions 'download functions' that 'are used to download packages from URLs provided by users or retrieved from package index servers' and 'are susceptible to code injection'. The package_index APIs listed handle URL processing and package distribution parsing, which are the download functions mentioned in the vulnerability description that can execute arbitrary commands when exposed to user-controlled inputs."
                },
                "CVE-2025-47273": {
                    "apis": [
                        "package_index.distros_for_url",
                        "package_index.interpret_distro_name",
                        "package_index.parse_bdist_wininst"
                    ],
                    "reason": "The CVE description explicitly states 'A path traversal vulnerability in PackageIndex' which would allow 'write files to arbitrary locations on the filesystem'. The package_index module APIs that process package distributions and URLs are directly related to this vulnerability, as they handle file paths and package extraction operations that could be exploited for path traversal attacks."
                }
            }
        }
    },
    "Werkzeug": {
        "2.0.2": {
            "cves": [
                "CVE-2023-25577",
                "CVE-2024-34069",
                "CVE-2023-46136",
                "CVE-2024-49766",
                "CVE-2024-49767",
                "CVE-2023-23934"
            ],
            "mapping_result": {
                "CVE-2023-25577": {
                    "apis": [
                        "formparser.parse_form_data",
                        "formparser.parse_multipart_headers",
                        "formparser.get_input_stream",
                        "formparser.default_stream_factory",
                        "wrappers.request.get_input_stream",
                        "wrappers.request.default_stream_factory"
                    ],
                    "reason": "The CVE description states 'Werkzeug's multipart form data parser will parse an unlimited number of parts' and mentions that 'an endpoint that accesses request.data, request.form, request.files, or request.get_data(parse_form_data=False)' can be exploited. The formparser.parse_form_data API is directly responsible for parsing multipart form data, and related APIs like parse_multipart_headers, get_input_stream, and default_stream_factory are involved in the multipart parsing process that leads to the resource exhaustion vulnerability."
                },
                "CVE-2024-34069": {
                    "apis": [
                        "debug.get_pin_and_cookie_name",
                        "debug.hash_pin",
                        "debug.parse_cookie",
                        "debug.render_console_html",
                        "debug.console.debug_repr",
                        "debug.console.dump",
                        "debug.get_current_traceback",
                        "debug.tbtools.render_console_html",
                        "debug.tbtools.get_current_traceback"
                    ],
                    "reason": "The CVE description states 'The debugger in affected versions of Werkzeug can allow an attacker to execute code' and mentions 'enter the debugger PIN' and 'allows access to the debugger even if it is only running on localhost'. The debug.get_pin_and_cookie_name and debug.hash_pin APIs are directly related to the debugger PIN mechanism, while debug.render_console_html and debug.console APIs are involved in rendering and executing the debugger console that allows code execution."
                },
                "CVE-2023-46136": {
                    "apis": [
                        "formparser.parse_form_data",
                        "formparser.parse_multipart_headers",
                        "formparser.get_input_stream",
                        "sansio.multipart.parse_options_header"
                    ],
                    "reason": "The CVE description states 'If an upload of a file that starts with CR or LF and then is followed by megabytes of data without these characters: all of these bytes are appended chunk by chunk into internal bytearray and lookup for boundary is performed on growing buffer' and mentions 'sending crafted multipart data to an endpoint that will parse it'. The formparser.parse_form_data and related multipart parsing APIs are directly responsible for parsing multipart data and performing boundary lookups, which is the vulnerable functionality described."
                },
                "CVE-2024-49766": {
                    "apis": [
                        "security.safe_join",
                        "middleware.shared_data.safe_join",
                        "utils.safe_join"
                    ],
                    "reason": "The CVE description explicitly states 'Werkzeug's safe_join() relies on this check' referring to os.path.isabs() not catching UNC paths on Windows, and mentions this 'can produce a path that is not safe, potentially allowing unintended access to data'. The safe_join APIs across different modules (security, middleware.shared_data, and utils) are directly mentioned as the vulnerable functionality."
                },
                "CVE-2024-49767": {
                    "apis": [
                        "formparser.parse_form_data",
                        "formparser.parse_multipart_headers",
                        "formparser.get_input_stream",
                        "formparser.default_stream_factory",
                        "wrappers.request.get_input_stream",
                        "wrappers.request.default_stream_factory"
                    ],
                    "reason": "The CVE description explicitly states 'Applications using werkzeug.formparser.MultiPartParser' and mentions 'parse multipart/form-data requests' where 'A specifically crafted form submission request can cause the parser to allocate and block 3 to 8 times the upload size in main memory'. The formparser.parse_form_data and related multipart parsing APIs are directly responsible for the vulnerable multipart form data parsing that causes resource exhaustion."
                },
                "CVE-2023-23934": {
                    "apis": [
                        "http.parse_cookie",
                        "debug.parse_cookie",
                        "sansio.request.parse_cookie",
                        "test.dump_cookie"
                    ],
                    "reason": "The CVE description states 'Werkzeug prior to 2.2.3 will parse the cookie =__Host-test=bad as __Host-test=bad' and mentions 'Browsers may allow nameless cookies that look like =value instead of key=value'. The http.parse_cookie and related cookie parsing APIs are directly responsible for parsing cookies, which is the vulnerable functionality that incorrectly handles nameless cookies."
                }
            }
        }
    }
}